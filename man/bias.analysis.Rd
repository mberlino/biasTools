% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bias.analysis.R
\name{bias.analysis}
\alias{bias.analysis}
\title{Bias Analysis for Publication Bias Detection}
\usage{
bias.analysis(
  dat,
  realm_name,
  moderator_col,
  moderator_label = NULL,
  id_col = "paper_count",
  only_change = TRUE,
  return_outliers = TRUE
)
}
\arguments{
\item{dat}{Dataframe containing the meta-analysis dataset.}

\item{realm_name}{Name of the realm to analyze (e.g., "freshwater", "marine", etc.).}

\item{moderator_col}{Column name of the moderator variable (e.g., "habitat", "stressor").}

\item{moderator_label}{Optional. Display name for the moderator (e.g., "Habitat").}

\item{id_col}{Column used to identify each row or case (e.g., "row_id" for row-level, "paper_count" for case-level).}

\item{only_change}{Logical. If TRUE (default), only considers outliers where publication bias significance changes.}

\item{return_outliers}{Logical. If TRUE (default), returns IDs of detected outliers.}
}
\value{
A list with:
\describe{
  \item{results}{A dataframe with statistics for each moderator level.}
  \item{outliers}{(Optional) A vector of IDs (from `id_col`) corresponding to outlier rows.}
}
}
\description{
Performs Egger-like publication bias analysis across all levels of a selected moderator within a specific realm.
Optionally returns the IDs of outlier observations to be removed.
}
\details{
The function runs three models per moderator level:
\itemize{
  \item \code{a_mod}: tests asymmetry using ~sqrt(vi)
  \item \code{b_mod}: baseline model including all data
  \item \code{g_mod}: baseline model after outlier removal
}
Outliers are determined by standardized residuals > |3| in model b.

#' Output of the function are organized in a  table as follow:
\itemize{
 \item \code{Moderator}: name od the selected moderator (es. "habitat")
 \item \code{level}: levels of the moderator (es. "lake", "stream"...)
 \item \code{n}: number od initial observation
 \item \code{g}`: estimate (effect size)
 \item \code{CI_95_before}: confidence interval al 95% before outliers exclusion
 \item \code{z_value}: z-score for asimmetry (Egger test)
 \item \code{p_value}: p-value for asimmetry
 \item \code{Outliers}:number of outliers identified
 \item \code{n_after}: number of observation without outliers
 \item \code{g_after}:new estimate for the model without outliers
 \item \code{CI_95_after}: new confidence interval
 \item \code{Change}: Indicate whether there are differences in significance levels between the initial and final models ("Yes" or "No")
}
}
\examples{
# Esempio di uso base:
dat$row_id <- 1:nrow(dat)
result <- bias.analysis(dat, "freshwater", "habitat", id_col = "row_id")

# Output examples:
#   Moderator   Habitat    n      g   CI_95_before  z_value  p_value  Outliers  n_after  g_after  CI_95_after  Change
#   Habitat     lake       120  0.21      0.13         2.91     0.004     5         115      0.19     0.12         No
#   Habitat     stream     300 -0.02      0.11         -0.45    0.65      8         292     -0.01     0.10         No

dat_clean <- dat[!(dat$row_id \%in\% res$outliers), ]

}
